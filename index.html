<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Geopolitics 2025 â€” v6hï¼ˆå–®æª”ç†±ä¿®ï¼‰</title>
<style>
  :root{ --bg:#0e1320; --card:#161b2d; --ink:#e9edff; --muted:#a6b1d6; --line:#242a48; --accent:#6ea8fe; --good:#70d7a0; --bad:#ff6b81; }
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;background:linear-gradient(180deg,#0e1320,#0a0f1a);color:var(--ink);
       font:15px/1.5 system-ui,-apple-system,"PingFang TC","Noto Sans TC",sans-serif}
  header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--line)}
  header h1{font-size:18px;margin:0}
  .small{font-size:12px;color:var(--muted)}
  main{display:grid;grid-template-columns:320px 1fr;gap:12px;padding:12px}
  @media (max-width:980px){ main{grid-template-columns:1fr} }
  .card{background:var(--card);border:1px solid var(--line);border-radius:12px;box-shadow:0 10px 24px rgba(0,0,0,.3)}
  .card h2{margin:0;padding:10px 12px;border-bottom:1px solid var(--line);font-size:15px}
  .section{padding:10px 12px}
  select,button{all:unset;background:#1a2140;border:1px solid #2a335f;border-radius:10px;padding:10px;cursor:pointer}
  button:hover{border-color:#3b4690} button:disabled{opacity:.5;cursor:not-allowed}
  .btn-cta{display:block;text-align:center;font-weight:700;margin-top:8px;background:#2b3566}
  .btn-cta::before{content:"ğŸš€ ";}
  .pill{display:inline-block;padding:4px 8px;border:1px solid #2a335f;border-radius:999px;color:var(--muted);margin-right:6px;margin-bottom:6px}
  .meters{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
  @media (max-width:720px){ .meters{grid-template-columns:1fr} }
  .meter{background:#121731;border:1px solid #2a335f;border-radius:8px;padding:8px}
  .bar{height:8px;background:#0b1024;border:1px solid #2a335f;border-radius:999px;overflow:hidden;margin-top:6px}
  .bar > span{display:block;height:100%;background:var(--accent);width:0%}
  .bar.good > span{background:var(--good)} .bar.bad > span{background:var(--bad)}
  .map{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
  @media (min-width:520px){ .map{grid-template-columns:repeat(6,1fr)} }
  .tile{background:#121731;border:1px solid #2a335f;border-radius:8px;padding:6px;text-align:center}
  .tile b{display:block;font-size:12px;color:var(--muted)}
  .tile span{display:block;margin-top:2px;font-weight:700}
  .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  .actions{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  @media (max-width:900px){ .actions{grid-template-columns:1fr} }
  .log{height:360px;overflow:auto;background:#0f1330;border:1px solid var(--line);border-radius:10px;padding:10px;font-family:ui-monospace,Menlo,Consolas,monospace}
  .toast{position:fixed;left:50%;bottom:22px;transform:translateX(-50%);background:#222b56;color:#e9edff;padding:10px 14px;border:1px solid #2a335f;border-radius:999px;opacity:0;transition:opacity .2s;z-index:5}
  .toast.show{opacity:1}
</style>
</head>
<body>
<header>
  <h1>Geopolitics 2025 â€” v6h</h1>
  <div class="small">å–®æª”ç†±ä¿®ï¼šå›ºå®šæœˆæ”¶ã€é›£åº¦ç”Ÿæ•ˆã€äº‹ä»¶ç¯€å¥ã€ç§‘æŠ€åŠ æˆã€è¡çªèª¿æ•´</div>
</header>

<main>
  <aside class="card">
    <h2>é–‹å±€è¨­å®š</h2>
    <div class="section">
      <label>é¸æ“‡åœ‹å®¶
        <select id="countrySelect" aria-label="é¸æ“‡åœ‹å®¶"></select>
      </label>
      <div class="row">
        <label>é›£åº¦
          <select id="difficulty" aria-label="é¸æ“‡é›£åº¦">
            <option value="easy">æ–°æ‰‹ï¼ˆæˆæœ¬-30% / RP=12ï¼‰</option>
            <option value="normal" selected>æ™®é€šï¼ˆRP=10ï¼‰</option>
            <option value="hard">åœ°ç„ï¼ˆæˆæœ¬+30% / RP=9ï¼‰</option>
          </select>
        </label>
      </div>
      <button id="btnStart" class="btn-cta">é–‹å§‹éŠæˆ²</button>
      <div class="small" style="margin-top:6px">å»ºè­°ï¼šå…ˆç© 5 å›åˆè§€å¯Ÿè²¡æ”¿/äº‹ä»¶ç¯€å¥ã€‚</div>
    </div>
    <h2>ä¸–ç•Œç¸½è¦½</h2>
    <div class="section">
      <div class="map" id="worldMap"></div>
      <div class="small" style="margin-top:6px">é¡è‰²ï¼šæ°‘ä¸» / å¨æ¬Š / æ··åˆ</div>
    </div>
  </aside>

  <section class="card">
    <h2>åœ‹å®¶å„€è¡¨ï¼ˆ<span id="uiCountry">â€”</span>ï¼‰</h2>
    <div class="section">
      <div class="row">
        <span class="pill">å›åˆï¼š<b id="turn">â€”</b></span>
        <span class="pill">æœ¬å›åˆ RPï¼š<b id="rp">â€”</b></span>
        <span class="pill">å›ºå®šæœˆæ”¶ï¼š<b id="revenue">â€”</b></span>
        <span class="pill">ç¾é‡‘ï¼š<b id="cash">â€”</b></span>
        <span class="pill">æ”¿é«”ï¼š<b id="regime">â€”</b></span>
      </div>
      <div class="meters" style="margin-top:8px">
        <div class="meter"><div>äººæ°‘å¥½æ„Ÿ</div><div class="bar good"><span id="mApproval"></span></div></div>
        <div class="meter"><div>åœ‹éš›æ”¯æŒ</div><div class="bar"><span id="mIntl"></span></div></div>
        <div class="meter"><div>æ•µå°æ…‹åº¦</div><div class="bar bad"><span id="mRivals"></span></div></div>
        <div class="meter"><div>è²¡æ”¿å¥åº·</div><div class="bar"><span id="mFiscal"></span></div></div>
      </div>
    </div>

    <h2>è¡Œå‹•ï¼ˆæ¶ˆè€— RPï¼‰</h2>
    <div class="section actions" id="actions"></div>
    <div class="section"><div class="row"><button id="btnEndTurn" disabled>çµæŸå›åˆ âœ çµç®—</button></div></div>

    <h2>ç§‘æŠ€æ¨¹ï¼ˆç°¡åŒ–ç¤ºæ„ï¼‰</h2>
    <div class="section"><div id="techList"></div></div>

    <h2>æˆ°å ±</h2>
    <div class="section log" id="log"></div>
  </section>
</main>

<div class="toast" id="toast">æç¤º</div>

<script>
const COUNTRIES=[
  ["USA","ç¾åœ‹","democracy",28500,0.26,90,{},["UK","CAN","JPN","AUS","KOR","DEU"],["CHN","RUS","IRN"]],
  ["CHN","ä¸­åœ‹","autocracy",17700,0.20,85,{},["RUS","IRN","PRK","PAK"],["USA","JPN","IND","TWN"]],
  ["TWN","å°ç£","democracy",790,0.17,60,{},["USA","JPN"],["CHN"]],
  ["JPN","æ—¥æœ¬","democracy",4200,0.28,75,{},["USA","TWN"],["CHN","PRK"]],
  ["KOR","éŸ“åœ‹","democracy",1900,0.25,70,{},["USA","JPN"],["PRK","CHN"]],
  ["IND","å°åº¦","hybrid",3600,0.18,70,{},["USA","FRA","AUS"],["CHN","PAK"]],
  ["RUS","ä¿„ç¾…æ–¯","autocracy",1900,0.18,80,{},["CHN","IRN"],["USA","UKR","NATO"]],
  ["UKR","çƒå…‹è˜­","democracy",200,0.16,60,{},["USA","POL"],["RUS"]],
  ["UK","è‹±åœ‹","democracy",3300,0.27,70,{},["USA","FRA","DEU"],["RUS"]],
  ["FRA","æ³•åœ‹","democracy",3000,0.29,70,{},["DEU","UK","USA"],["RUS"]],
  ["DEU","å¾·åœ‹","democracy",4400,0.30,65,{},["FRA","POL","USA"],["RUS"]],
  ["ITA","ç¾©å¤§åˆ©","democracy",2100,0.29,55,{},["DEU","FRA"],[""]],
  ["ESP","è¥¿ç­ç‰™","democracy",1600,0.28,50,{},["FRA","DEU"],[""]],
  ["POL","æ³¢è˜­","democracy",800,0.19,60,{},["USA","UKR","DEU"],["RUS"]],
  ["TUR","åœŸè€³å…¶","hybrid",905,0.20,65,{},["AZE","QAT"],["GRC","SYR"]],
  ["IRN","ä¼Šæœ—","autocracy",388,0.15,65,{},["RUS","SYR"],["USA","ISR","KSA"]],
  ["ISR","ä»¥è‰²åˆ—","democracy",520,0.23,70,{},["USA"],["IRN"]],
  ["KSA","æ²™çƒåœ°é˜¿æ‹‰ä¼¯","autocracy",1100,0.10,65,{},["UAE","EGY"],["IRN"]],
  ["UAE","é˜¿è¯é…‹","autocracy",500,0.05,55,{},["KSA"],["IRN"]],
  ["EGY","åŸƒåŠ","autocracy",475,0.15,50,{},["KSA"],["ETH"]],
  ["NGA","å¥ˆåŠåˆ©äº","hybrid",480,0.08,45,{},["GHA"],["BOKO"]],
  ["ZAF","å—é","democracy",420,0.20,50,{},[""],[""]],
  ["BRA","å·´è¥¿","democracy",2260,0.22,55,{},["ARG"],["VEN"]],
  ["ARG","é˜¿æ ¹å»·","democracy",620,0.18,45,{},["BRA"],[""]],
  ["MEX","å¢¨è¥¿å“¥","democracy",1700,0.17,50,{},["USA","CAN"],[""]],
  ["CAN","åŠ æ‹¿å¤§","democracy",2300,0.27,60,{},["USA"],[""]],
  ["AUS","æ¾³æ´²","democracy",1700,0.25,60,{},["USA","JPN"],["CHN"]],
  ["IDN","å°å°¼","democracy",1500,0.12,50,{},[""],[""]],
  ["VNM","è¶Šå—","autocracy",430,0.10,55,{},["RUS"],["CHN (æµ·)"]],
  ["THA","æ³°åœ‹","hybrid",540,0.15,50,{},[""],[""]]
];

const TECH=[
  {id:"mil_uav_swarm",domain:"mil",name:"ç„¡äººæ©Ÿèœ‚ç¾¤",cost:120,turns:6,effects:{mil:3,intel:1}},
  {id:"mil_missile_defense",domain:"mil",name:"é£›å½ˆé˜²ç¦¦",cost:180,turns:8,effects:{mil:4}},
  {id:"it_ai_compute",domain:"it",name:"AI ç®—åŠ›ä¸­å¿ƒ",cost:200,turns:10,effects:{econ:3,intel:1}},
  {id:"ind_smart_grid",domain:"energy",name:"æ™ºæ…§é›»ç¶²",cost:160,turns:7,effects:{econ:2,stability:1}},
  {id:"bio_public_health",domain:"bio",name:"å…¬å…±è¡›ç”Ÿæ•¸ä½åŒ–",cost:130,turns:6,effects:{stability:1,fiscal:1}}
];

const ACTIONS=[
  {id:"military", name:"è»äº‹éƒ¨ç½²ï¼ˆRP4/é‡‘20ï¼‰", rp:4, cost:20, effect:(S)=>{
    S.approval -= 1; S.rivals += 5; S.intl -= 1;
    toast("è»äº‹éƒ¨ç½²ï¼šæ°‘å¿ƒ-1ã€æ•µå°+5ã€åœ‹éš›-1");
  }},
  {id:"conflict", name:"é‚Šå¢ƒè¡çªï¼ˆRP6/é‡‘40ï¼‰", rp:6, cost:40, effect:(S)=>{
    const roll = d6() + (S.intel>=60?1:0) + (S.techMil?1:0);
    if(roll<=2){ S.approval-=4; S.intl-=2; log(`å¤±åˆ©ï¼ˆ${roll}ï¼‰æ°‘å¿ƒ-4 åœ‹éš›-2`); }
    else if(roll==3){ log(`åƒµæŒï¼ˆ${roll}ï¼‰`); }
    else if(roll<=5){ S.rivals=Math.max(0,S.rivals-4); log(`å°å‹ï¼ˆ${roll}ï¼‰æ•µå°-4`); }
    else{ S.rivals=Math.max(0,S.rivals-8); S.approval+=2; log(`å¤§å‹ï¼ˆ${roll}ï¼‰æ•µå°-8 æ°‘å¿ƒ+2`); }
  }},
  {id:"diplomacy", name:"å¤–äº¤æ‹‰æ”ï¼ˆRP3/é‡‘10ï¼‰", rp:3, cost:10, effect:(S)=>{
    S.intl += 2; toast("å¤–äº¤ï¼šåœ‹éš›æ”¯æŒ +2");
  }},
  {id:"welfare", name:"ç¤¾æœƒç¦åˆ©ï¼ˆRP3/é‡‘25ï¼‰", rp:3, cost:25, effect:(S)=>{
    S.approval += 4; S.fiscal -= 2; toast("ç¦åˆ©ï¼šæ°‘å¿ƒ +4ã€è²¡æ”¿ -2");
  }},
  {id:"propaganda", name:"å®£å‚³æˆ°ï¼ˆRP2/é‡‘8ï¼‰", rp:2, cost:8, effect:(S)=>{
    const r=d6();
    if(r==1){ S.approval-=2; S.intl-=1; toast("å®£å‚³åå™¬"); }
    else if(r<=3){ S.approval+=1; toast("å®£å‚³æˆæ•ˆæœ‰é™ï¼šæ°‘å¿ƒ +1"); }
    else{ S.approval+=3; S.intl+=1; toast("å®£å‚³æˆæ•ˆè‰¯å¥½ï¼šæ°‘å¿ƒ +3ã€åœ‹éš› +1"); }
  }},
];

const State={started:false,turn:0,rp:0,baseRevenue:0,money:0,country:null,difficulty:"normal",
             approval:55,intl:50,rivals:50,fiscal:55,intel:50,techProgress:{},techBoostTemp:0};

function d6(){ return Math.floor(Math.random()*6)+1; }
function clamp(v,min=0,max=100){ return Math.max(min,Math.min(max,v)); }
function log(t){ const div=document.getElementById('log'); const p=document.createElement('p'); p.textContent=t; div.appendChild(p); div.scrollTop=div.scrollHeight; }
function toast(t){ const el=document.getElementById('toast'); el.textContent=t; el.classList.add('show'); setTimeout(()=>el.classList.remove('show'), 1200); }

document.addEventListener('DOMContentLoaded', ()=>{
  // å¡«å…¥åœ‹å®¶
  const sel=document.getElementById('countrySelect');
  COUNTRIES.forEach(c=>{ const o=document.createElement('option'); o.value=c[0]; o.textContent=`${c[1]} (${c[0]})`; sel.appendChild(o); });
  // åœ°åœ–
  const world=document.getElementById('worldMap');
  COUNTRIES.forEach(c=>{ const d=document.createElement('div'); d.className='tile'; d.innerHTML=`<b>${c[1]}</b><span>${c[2]}</span>`; world.appendChild(d); });
  // æŒ‰éˆ•
  document.getElementById('btnStart').onclick=startGame;
  document.getElementById('btnEndTurn').onclick=endTurn;
});

function startGame(){
  const id=document.getElementById('countrySelect').value;
  const diff=document.getElementById('difficulty').value;
  const c=COUNTRIES.find(x=>x[0]===id);
  const baseRevenue=Math.round(c[3]*c[4]/12/10);
  Object.assign(State, {
    started:true, turn:1,
    baseRevenue, money: baseRevenue*2,
    country:c, difficulty:diff,
    approval:55, intl:50, rivals:50, fiscal:55, intel:50,
    techProgress:{}, techBoostTemp:0
  });
  // é›£åº¦ä¿‚æ•¸
  if(diff==="easy"){ State.costMul=0.7;  State.rp=12; }
  else if(diff==="hard"){ State.costMul=1.3; State.rp=9; }
  else { State.costMul=1.0; State.rp=10; }

  // UI
  document.getElementById('uiCountry').textContent=`${c[1]} (${c[0]})`;
  document.getElementById('regime').textContent=c[2];
  document.getElementById('btnEndTurn').disabled=false;
  document.getElementById('log').innerHTML="";
  log(`âœ… v6h å•Ÿå‹•ï¼š${c[1]}ï½œé›£åº¦=${diff}ï½œå›ºå®šæœˆæ”¶=${State.baseRevenue}`);
  buildActions(); buildTech(); updateMeters();
}

function updateMeters(){
  document.getElementById('turn').textContent=State.turn;
  document.getElementById('rp').textContent=State.rp;
  document.getElementById('revenue').textContent=State.baseRevenue;
  document.getElementById('cash').textContent=State.money;
  document.getElementById('mApproval').style.width=clamp(State.approval)+'%';
  document.getElementById('mIntl').style.width=clamp(State.intl)+'%';
  document.getElementById('mRivals').style.width=clamp(State.rivals)+'%';
  document.getElementById('mFiscal').style.width=clamp(State.fiscal)+'%';
}

function spend(rp,cost){
  const realCost=Math.round(cost*State.costMul);
  if(State.rp<rp){ toast("RP ä¸è¶³"); return false; }
  if(State.money<realCost){ toast("é‡‘éŒ¢ä¸è¶³"); return false; }
  State.rp-=rp; State.money-=realCost; updateMeters(); return true;
}

function buildActions(){
  const wrap=document.getElementById('actions'); wrap.innerHTML='';
  ACTIONS.forEach(a=>{
    const btn=document.createElement('button'); btn.textContent=a.name;
    btn.onclick=()=>{ if(spend(a.rp,a.cost)){ a.effect(State); updateMeters(); } };
    wrap.appendChild(btn);
  });
}

function buildTech(){
  const box=document.getElementById('techList'); box.innerHTML='';
  TECH.forEach(t=>{
    const p=State.techProgress[t.id]||{left:t.turns,started:false,done:false}; State.techProgress[t.id]=p;
    const pct=p.done?100:Math.round(100*(1-p.left/t.turns));
    const card=document.createElement('div'); card.className='meter';
    card.innerHTML=`<div><b>[${t.domain}] ${t.name}</b></div>
      <div class="bar"><span style="width:${pct}%"></span></div>
      <div class="small">æˆæœ¬:${Math.round(t.cost*State.costMul)} å›åˆ:${t.turns} å‰©:${p.done?0:p.left}</div>
      <div class="row">
        <button ${p.started&&!p.done?'disabled':''} data-id="${t.id}">${p.done?'å·²å®Œæˆ':'æŠ•å…¥ç ”ç©¶ï¼ˆRP3/é‡‘30%ï¼‰'}</button>
        <button ${(!p.started||p.done)?'disabled':''} data-acc="${t.id}">åŠ é€Ÿï¼ˆRP2/é‡‘15ï¼‰</button>
      </div>`;
    box.appendChild(card);
  });
  box.querySelectorAll('button[data-id]').forEach(b=>{
    b.onclick=()=>{
      const id=b.getAttribute('data-id'); const t=TECH.find(x=>x.id===id);
      const p=State.techProgress[id]; if(p.done) return;
      if(!spend(3, Math.round(t.cost*0.3))) return;
      p.started=true; log(`é–‹å§‹ç ”ç©¶ï¼š${t.name}ï¼ˆå‰© ${p.left} å›åˆï¼‰`); buildTech();
    };
  });
  box.querySelectorAll('button[data-acc]').forEach(b=>{
    b.onclick=()=>{
      const id=b.getAttribute('data-acc'); const t=TECH.find(x=>x.id===id);
      const p=State.techProgress[id]; if(!p.started||p.done) return;
      if(!spend(2,15)) return;
      p.left=Math.max(1,p.left-1); log(`åŠ é€Ÿç ”ç©¶ï¼š${t.name}ï¼ˆå‰© ${p.left} å›åˆï¼‰`); buildTech();
    };
  });
}

function applyTech(t){
  const e=t.effects||{};
  if(e.mil) State.rivals = clamp(State.rivals - e.mil);
  if(e.econ) State.baseRevenue += Math.round(e.econ * 2);
  if(e.intel) State.intel = clamp(State.intel + e.intel, 0, 100);
  if(e.fiscal) State.fiscal = clamp(State.fiscal + e.fiscal);
  if(e.stability) State.approval = clamp(State.approval + e.stability);
  if(e.approval) State.approval = clamp(State.approval + e.approval);
  updateMeters();
}

function endTurn(){
  if(!State.started) return;
  // 1) ç§‘æŠ€é€²åº¦ï¼ˆå«è‡¨æ™‚åŠ é€Ÿï¼‰
  TECH.forEach(t=>{
    const p=State.techProgress[t.id];
    if(p && p.started && !p.done){
      p.left = Math.max(0, p.left-1);
      if(p.left===0){ p.done=true; applyTech(t); log(`ç§‘æŠ€å®Œæˆï¼š${t.name}`); }
    }
  });

  // 2) äº‹ä»¶ï¼ˆæ¯å›åˆ 1 å‰‡ï¼Œå¼·åº¦ä¾æ“²éª°ï¼‰
  const r=d6();
  if(r<=2){ State.fiscal-=2; log("äº‹ä»¶ï¼šå¸‚å ´æ³¢å‹•ï¼ˆä¸­ï¼‰â†’ è²¡æ”¿ -2"); }
  else if(r<=4){ State.intl+=1; log("äº‹ä»¶ï¼šç›Ÿå‹åˆä½œï¼ˆè¼•ï¼‰â†’ åœ‹éš› +1"); }
  else{ State.approval+=1; log("äº‹ä»¶ï¼šé«”è‚²ä½³ç¸¾ï¼ˆè¼•ï¼‰â†’ æ°‘å¿ƒ +1"); }

  // 3) å›ºå®šæœˆæ”¶é€²å¸³
  State.money += Math.max(0, State.baseRevenue);

  // 4) å›åˆæ¨é€² + RP è£œå……ï¼ˆåƒé›£åº¦ï¼‰
  State.turn++;
  State.rp = (State.difficulty==="easy"?12:(State.difficulty==="hard"?9:10));

  updateMeters();
  log(`â€”â€” é€²å…¥ç¬¬ ${State.turn} å›åˆ â€”â€”`);
}
</script>
</body>
</html>
